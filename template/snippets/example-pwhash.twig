const {
    Password,
    SymmetricKey
} = require('dhole-crypto');

/** @var {SymmetricKey} symmetricKey */
let pwHandler = new Password(symmetricKey);
let password = 'correct horse battery staple';
let pwhash = pwHandler.hash(password);

if (pwHandler.verify(password, pwhash)) {
    if (pwHandler.needsRehash(pwhash)) {
        pwhash = pwHandler.hash(password);
        // Store updated pwhash in database...
    }
    console.log('Access granted.');
}
